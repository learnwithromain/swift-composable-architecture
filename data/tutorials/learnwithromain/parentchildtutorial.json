{"metadata":{"category":"The Composable Architecture","categoryPathComponent":"RefineComposableArchitecture","role":"project","title":"Building a Parent-Child Relationship"},"variants":[{"paths":["\/tutorials\/learnwithromain\/parentchildtutorial"],"traits":[{"interfaceLanguage":"swift"}]}],"kind":"project","identifier":{"url":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/RefineComposableArchitecture","doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/RefineComposableArchitecture\/$volume","doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/RefineComposableArchitecture\/Composing-features"]],"reference":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/RefineComposableArchitecture","modules":[{"projects":[{"reference":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial","sections":[{"reference":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial#Creating-a-parent-view-with-a-child-view","kind":"task"},{"kind":"task","reference":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial#Communication-from-Child-to-Parent"},{"reference":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial#Communication-from-Parent-to-Child","kind":"task"}]}],"reference":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/RefineComposableArchitecture\/Composing-features"}]},"schemaVersion":{"minor":3,"patch":0,"major":0},"sections":[{"kind":"hero","title":"Building a Parent-Child Relationship","chapter":"Composing features","estimatedTimeInMinutes":30,"content":[{"inlineContent":[{"type":"text","text":"Learn how to operate Parent-child communication in between TCA features. We will create a parent and child feature and make them communicate with each other."}],"type":"paragraph"}]},{"tasks":[{"contentSection":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"We will compose the parent and child feature together."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This is a practice that enable us to build complex functionality by combining smaller, more manageable features."}]}],"kind":"contentAndMedia","mediaPosition":"trailing"}],"anchor":"Creating-a-parent-view-with-a-child-view","stepsSection":[{"media":null,"code":"01-01-01-code0001.swift","runtimePreview":null,"caption":[{"name":"Note","style":"note","type":"aside","content":[{"inlineContent":[{"text":"Since TCA 1.8, @Reducer macro automatically fulfills the reducer requirements. Our body does not have any logic, so we can omit it.","type":"text"}],"type":"paragraph"}]}],"type":"step","content":[{"type":"paragraph","inlineContent":[{"text":"Create a new file called ","type":"text"},{"code":"ChildFeature.swift","type":"codeVoice"},{"text":". This feature contains a - and + button with a label that specify the current value.","type":"text"}]}]},{"runtimePreview":null,"type":"step","content":[{"type":"paragraph","inlineContent":[{"text":"Create a new file called ","type":"text"},{"type":"codeVoice","code":"ParentFeature.swift"},{"type":"text","text":" with some basic scaffolding in place."}]}],"code":"01-01-01-code0002.swift","media":null,"caption":[{"style":"note","content":[{"type":"paragraph","inlineContent":[{"text":"Since TCA 1.8, @Reducer macro automatically fulfills the reducer requirements.","type":"text"}]}],"name":"Note","type":"aside"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Let’s compose the features together at the reducer level."}]},{"runtimePreview":null,"code":"01-01-01-code0003.swift","type":"step","caption":[],"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Add a State and Action to the reducer. The parent reducer will hold the state and actions of the Child reducer."}]}],"media":null},{"code":"01-01-01-code0004.swift","media":null,"runtimePreview":null,"type":"step","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Next we need to implement the body of the reducer. Previously it was empty because we had no actions. To compose the child reducer in the parent reducer, we use the "},{"type":"reference","isActive":true,"identifier":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/scope"},{"text":" reducer. It allows you to focus in on a sub-domain of the parent feature, and run a child reducer on that sub-domain.","type":"text"}]}],"caption":[{"name":"Note","style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"It exposes child state and action to the parent reducer."}]}],"type":"aside"}]},{"inlineContent":[{"type":"text","text":"Let’s compose the features together at the view level."}],"type":"paragraph"},{"media":null,"caption":[],"type":"step","runtimePreview":null,"content":[{"type":"paragraph","inlineContent":[{"text":"Use the ","type":"text"},{"isActive":true,"identifier":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/store\/scope(state:action:)-90255","type":"reference"},{"text":" method on the store to derive a child store focused in on just the child domain.","type":"text"}]}],"code":"01-01-01-code0005.swift"},{"type":"paragraph","inlineContent":[{"text":"The two views are now composed together:","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The parent state consists of its own values and the child state."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"The Store of the Child is a scoped variant of the parent."}],"type":"paragraph"}]}],"type":"unorderedList"}],"title":"Creating a parent view with a child view"},{"title":"Communication from Child to Parent","stepsSection":[{"inlineContent":[{"text":"Let’s see how the child chould communicate with a parent feature.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If the parent needs to respond to events happening into the child, it can simply listen to the corresponding actions that arrive in the reducer."}]},{"code":"01-01-02-code0001.swift","runtimePreview":null,"media":null,"caption":[{"style":"note","type":"aside","content":[{"type":"paragraph","inlineContent":[{"text":"This is possible thanks to Scope reducer","type":"text"}]}],"name":"Note"}],"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"We just need to add an action to listen to from the child reducer."}]}],"type":"step"},{"type":"paragraph","inlineContent":[{"type":"text","text":"There is no need to add extra code in order to be aware of the current state of the child reducer since the parent reducer has a reference to it."}]}],"anchor":"Communication-from-Child-to-Parent","contentSection":[{"kind":"contentAndMedia","content":[{"inlineContent":[{"text":"Parent-child communication refers to the exchange of information or triggering of actions between hierarchical views.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"The terms “parent” and “child” are used to describe the relationship between different components or modules within an app.","type":"text"}],"type":"paragraph"}],"mediaPosition":"trailing"}]},{"stepsSection":[{"type":"paragraph","inlineContent":[{"type":"text","text":"If the parent needs to reuse the logic from the child through sending an action, it can be done by invoking the child reducer directly."}]},{"caption":[],"type":"step","runtimePreview":null,"content":[{"type":"paragraph","inlineContent":[{"text":"To send an action from the parent to the child, invoke the child reducer with a reduce method ","type":"text"},{"identifier":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/performance\/#Sharing-logic-in-child-features","isActive":true,"type":"reference"},{"text":".","type":"text"}]}],"code":"01-01-03-code0001.swift","media":null},{"type":"paragraph","inlineContent":[{"type":"text","text":"If the parent needs to update the state of the child, without any shared logic, we can create an extension on the child state."}]},{"runtimePreview":null,"type":"step","caption":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"It is better to use a mutating method rather than updating the child state directly from the parent reducer as a new child reducer would be recreated."}]}],"name":"Note","style":"note","type":"aside"}],"media":null,"code":"01-01-03-code0002.swift","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"We implement a mutating method where we update any needed state and return an action."}]}]}],"title":"Communication from Parent to Child","anchor":"Communication-from-Parent-to-Child","contentSection":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"We’ve seen how the child communicate to its parent. The same approch cannot be follow."}]}],"mediaPosition":"trailing","kind":"contentAndMedia"}]}],"kind":"tasks"}],"references":{"doc://com.learnwithromain.learnwithromain/tutorials/RefineComposableArchitecture/Composing-features":{"title":"Composing features","role":"article","abstract":[],"kind":"article","identifier":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/RefineComposableArchitecture\/Composing-features","url":"\/tutorials\/refinecomposablearchitecture\/composing-features","type":"topic"},"doc://com.learnwithromain.learnwithromain/tutorials/RefineComposableArchitecture":{"title":"Refine the Composable Architecture","role":"overview","abstract":[{"text":"This interactive tutorial aims to provide best practices for building a project with TCA.","type":"text"}],"kind":"overview","identifier":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/RefineComposableArchitecture","url":"\/tutorials\/refinecomposablearchitecture","type":"topic"},"https://pointfreeco.github.io/swift-composable-architecture/main/documentation/composablearchitecture/scope":{"url":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/scope","title":" Scope","titleInlineContent":[{"type":"text","text":" Scope"}],"identifier":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/scope","type":"link"},"doc://com.learnwithromain.learnwithromain/tutorials/learnwithromain/ParentChildTutorial#Communication-from-Parent-to-Child":{"title":"Communication from Parent to Child","role":"pseudoSymbol","abstract":[{"type":"text","text":"Learn how to operate Parent-child communication in between TCA features. We will create a parent and child feature and make them communicate with each other."}],"kind":"section","identifier":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial#Communication-from-Parent-to-Child","url":"\/tutorials\/learnwithromain\/parentchildtutorial#Communication-from-Parent-to-Child","type":"section"},"01-01-01-code0001.swift":{"content":["import ComposableArchitecture","import SwiftUI","","@Reducer","struct ChildFeature {","    @ObservableState","    struct State {","        var number: Int","    }","    ","    enum Action {","        case minusButtonTapped","        case plusButtonTapped","    }","}","","struct ChildView: View {","    let store: StoreOf<ChildFeature>","    ","    var body: some View {","        HStack {","            Button(\"-\") {","                send(.minusButtonTapped)","            }","            Text(String(store.number))","            Button(\"+\") {","                send(.plusButtonTapped)","            }","        }","    }","}"],"fileType":"swift","fileName":"ChildFeature.swift","syntax":"swift","identifier":"01-01-01-code0001.swift","highlights":[],"type":"file"},"01-01-03-code0002.swift":{"content":["import ComposableArchitecture","import SwiftUI","","@Reducer","struct ParentFeature {","    @ObservableState","    struct State {","        var child: ChildFeature.State","    }","    ","    enum Action {","        case child(ChildFeature.Action)","    }","    ","    var body: some ReducerOf<Self> {","        Scope(state: \\.child, action: \\.child) {","            ChildFeature()","        }","        ","        Reduce { state, action in","            switch action {","            case .child(.plusButtonTapped):","                let newNumber = state.child.number + 1","                return state.child.updateNumber(with: newNumber).map(Action.child)","            }","        }","    }","}","","extension ChildFeature.State {","    mutating func updateNumber(with number: Int) -> Effect<ChildFeature.Action> {","        self.number = number","        return .none","    }","}","","struct ParentView: View {","    let store: StoreOf<ParentFeature>","    ","    var body: some View {","        VStack {","            ChildView(store: store.scope(","                state: \\.child,","                action: \\.child","            ))","        }","    }","}"],"fileType":"swift","fileName":"ParentFeature.swift","syntax":"swift","identifier":"01-01-03-code0002.swift","highlights":[{"line":23},{"line":24},{"line":30},{"line":31},{"line":32},{"line":33},{"line":34},{"line":35},{"line":36}],"type":"file"},"https://pointfreeco.github.io/swift-composable-architecture/main/documentation/composablearchitecture/store/scope(state:action:)-90255":{"url":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/store\/scope(state:action:)-90255","title":" scope(state:action:)","titleInlineContent":[{"text":" scope(state:action:)","type":"text"}],"identifier":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/store\/scope(state:action:)-90255","type":"link"},"01-01-03-code0001.swift":{"content":["import ComposableArchitecture","import SwiftUI","","@Reducer","struct ParentFeature {","    @ObservableState","    struct State {","        var child: ChildFeature.State","    }","    ","    enum Action {","        case child(ChildFeature.Action)","    }","    ","    var body: some ReducerOf<Self> {","        Scope(state: \\.child, action: \\.child) {","            ChildFeature()","        }","        ","        Reduce { state, action in","            switch action {","            case .child(.plusButtonTapped):","                return ChildFeature().reduce(into: &state.child, action: .otherMinusAction).map(Action.child)","            }","        }","    }","}","","struct ParentView: View {","    let store: StoreOf<ParentFeature>","    ","    var body: some View {","        VStack {","            ChildView(store: store.scope(","                state: \\.child,","                action: \\.child","            ))","        }","    }","}",""],"fileType":"swift","fileName":"ParentFeature.swift","syntax":"swift","identifier":"01-01-03-code0001.swift","highlights":[{"line":23}],"type":"file"},"01-01-01-code0003.swift":{"content":["import ComposableArchitecture","import SwiftUI","","@Reducer","struct ParentFeature {","    @ObservableState","    struct State {","        var child: ChildFeature.State","    }","    ","    enum Action {","        case child(ChildFeature.Action)","    }","    ","    var body: some ReducerOf<Self> {","        Reduce { state, action in","            \/\/ Core logic of the app feature","            return .none","        }","    }","}","","struct ParentView: View {","    let store: StoreOf<ParentFeature>","    ","    var body: some View {","        EmptyView()","    }","}",""],"fileType":"swift","fileName":"ParentFeature.swift","syntax":"swift","identifier":"01-01-01-code0003.swift","highlights":[{"line":5},{"line":6},{"line":7},{"line":8},{"line":9},{"line":10},{"line":11},{"line":12},{"line":13},{"line":14},{"line":15},{"line":16},{"line":17},{"line":18},{"line":19},{"line":20},{"line":21}],"type":"file"},"01-01-01-code0004.swift":{"content":["import ComposableArchitecture","import SwiftUI","","@Reducer","struct ParentFeature {","    @ObservableState","    struct State {","        var child: ChildFeature.State","    }","    ","    enum Action {","        case child(ChildFeature.Action)","    }","    ","    var body: some ReducerOf<Self> {","        Scope(state: \\.child, action: \\.child) {","            ChildFeature()","        }","        ","        Reduce { state, action in","            \/\/ Core logic of the app feature","            return .none","        }","    }","}","","struct ParentView: View {","    let store: StoreOf<ParentFeature>","    ","    var body: some View {","        EmptyView()","    }","}",""],"fileType":"swift","fileName":"ParentFeature.swift","syntax":"swift","identifier":"01-01-01-code0004.swift","highlights":[{"line":16},{"line":17},{"line":18},{"line":19}],"type":"file"},"doc://com.learnwithromain.learnwithromain/tutorials/learnwithromain/ParentChildTutorial":{"title":"Building a Parent-Child Relationship","role":"project","abstract":[{"text":"Learn how to operate Parent-child communication in between TCA features. We will create a parent and child feature and make them communicate with each other.","type":"text"}],"kind":"project","identifier":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial","url":"\/tutorials\/learnwithromain\/parentchildtutorial","type":"topic","estimatedTime":"30min"},"doc://com.learnwithromain.learnwithromain/tutorials/learnwithromain/ParentChildTutorial#Creating-a-parent-view-with-a-child-view":{"title":"Creating a parent view with a child view","role":"pseudoSymbol","abstract":[{"text":"Learn how to operate Parent-child communication in between TCA features. We will create a parent and child feature and make them communicate with each other.","type":"text"}],"kind":"section","identifier":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial#Creating-a-parent-view-with-a-child-view","url":"\/tutorials\/learnwithromain\/parentchildtutorial#Creating-a-parent-view-with-a-child-view","type":"section"},"01-01-01-code0005.swift":{"content":["import ComposableArchitecture","import SwiftUI","","@Reducer","struct ParentFeature {","    @ObservableState","    struct State {","        var child: ChildFeature.State","    }","    ","    enum Action {","        case child(ChildFeature.Action)","    }","    ","    var body: some ReducerOf<Self> {","        Scope(state: \\.child, action: \\.child) {","            ChildFeature()","        }","        ","        Reduce { state, action in","            \/\/ Core logic of the app feature","            return .none","        }","    }","}","","struct ParentView: View {","    let store: StoreOf<ParentFeature>","    ","    var body: some View {","        VStack {","            ChildView(store: store.scope(","                state: \\.child,","                action: \\.child","            ))","        }","    }","}",""],"fileType":"swift","fileName":"ParentFeature.swift","syntax":"swift","identifier":"01-01-01-code0005.swift","highlights":[{"line":31},{"line":32},{"line":33},{"line":34},{"line":35},{"line":36}],"type":"file"},"01-01-02-code0001.swift":{"content":["import ComposableArchitecture","import SwiftUI","","@Reducer","struct ParentFeature {","    @ObservableState","    struct State {","        var child: ChildFeature.State","    }","    ","    enum Action {","        case child(ChildFeature.Action)","    }","    ","    var body: some ReducerOf<Self> {","        Scope(state: \\.child, action: \\.child) {","            ChildFeature()","        }","        ","        Reduce { state, action in","            switch action {","            case .child(.plusButtonTapped):","                \/\/ We listen to the plusButtonTapped child action","                return .none","            default:","                return .none","            }","        }","    }","}","","struct ParentView: View {","    let store: StoreOf<ParentFeature>","    ","    var body: some View {","        VStack {","            ChildView(store: store.scope(","                state: \\.child,","                action: \\.child","            ))","        }","    }","}",""],"fileType":"swift","fileName":"ParentFeature.swift","syntax":"swift","identifier":"01-01-02-code0001.swift","highlights":[{"line":21},{"line":22},{"line":23},{"line":24},{"line":25},{"line":26},{"line":27}],"type":"file"},"doc://com.learnwithromain.learnwithromain/tutorials/learnwithromain/ParentChildTutorial#Communication-from-Child-to-Parent":{"title":"Communication from Child to Parent","role":"pseudoSymbol","abstract":[{"text":"Learn how to operate Parent-child communication in between TCA features. We will create a parent and child feature and make them communicate with each other.","type":"text"}],"kind":"section","identifier":"doc:\/\/com.learnwithromain.learnwithromain\/tutorials\/learnwithromain\/ParentChildTutorial#Communication-from-Child-to-Parent","url":"\/tutorials\/learnwithromain\/parentchildtutorial#Communication-from-Child-to-Parent","type":"section"},"https://pointfreeco.github.io/swift-composable-architecture/main/documentation/composablearchitecture/performance/#Sharing-logic-in-child-features":{"identifier":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/performance\/#Sharing-logic-in-child-features","type":"link","titleInlineContent":[{"type":"text","text":"Sharing logic in child features"}],"title":"Sharing logic in child features","url":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/documentation\/composablearchitecture\/performance\/#Sharing-logic-in-child-features"},"01-01-01-code0002.swift":{"content":["import ComposableArchitecture","import SwiftUI","","@Reducer","struct ParentFeature {}","","struct ParentView: View {","    let store: StoreOf<ParentFeature>","    ","    var body: some View {","        EmptyView()","    }","}",""],"fileType":"swift","fileName":"ParentFeature.swift","syntax":"swift","identifier":"01-01-01-code0002.swift","highlights":[],"type":"file"}}}